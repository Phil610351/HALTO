from keras.layers import Flatten, Dense, Activation
from statsmodels.tsa import arima_model
from keras.models import Sequential
from math import log2
import matplotlib.pyplot as plt
import numpy as np

#len 302, max63
traffic=[29, 32, 39, 43, 50, 38, 38, 22, 12, 6, 3, 2, 3, 3, 7, 12, 15, 20, 28, 26, 33, 39, 36, 44, 30, 36, 41, 50, 48, 45, 32, 22, 12, 7, 4, 2, 1, 3, 7, 13, 25, 30, 28, 37, 39, 42, 47, 38, 32, 43, 45, 44, 49, 51, 42, 31, 19, 9, 5, 3, 2, 3, 6, 13, 19, 27, 27, 32, 43, 47, 55, 46, 35, 36, 39, 43, 38, 46, 37, 29, 23, 15, 6, 2, 1, 2, 4, 6, 13, 18, 26, 35, 37, 37, 36, 43, 39, 37, 48, 43, 43, 40, 35, 31, 21, 14, 6, 3, 2, 2, 3, 7, 11, 17, 25, 34, 40, 41, 43, 38, 26, 32, 41, 36, 43, 52, 39, 28, 20, 13, 6, 4, 3, 3, 7, 17, 24, 26, 37, 34, 39, 38, 46, 44, 37, 38, 47, 48, 52, 59, 46, 30, 16, 9, 3, 2, 3, 3, 6, 16, 19, 23, 26, 32, 33, 39, 44, 43, 33, 41, 42, 39, 51, 57, 44, 28, 20, 10, 5, 2, 1, 3, 6, 12, 23, 28, 27, 34, 35, 48, 50, 49, 36, 44, 45, 44, 49, 51, 48, 32, 20, 12, 5, 4, 2, 3, 6, 15, 19, 19, 33, 33, 33, 43, 46, 39, 35, 42, 48, 47, 51, 63, 50, 35, 24, 14, 6, 3, 2, 2, 6, 14, 22, 29, 26, 33, 42, 48, 48, 42, 37, 41, 41, 38, 41, 40, 33, 26, 22, 12, 5, 3, 1, 2, 3, 9, 14, 20, 22, 29, 33, 35, 38, 41, 35, 38, 38, 42, 42, 42, 36, 31, 24, 17, 9, 5, 4, 3, 3, 3, 10, 16, 21, 29, 33, 39, 42, 39, 32, 46, 49, 52, 52, 57, 45, 32, 20, 10, 3, 4, 3, 2]

history=6
actions=10
epsilon=1
gamma=0.9
zeta=10
MEC=1
B=1
N=1e-10

Realtime='SS'

num=1

def cal_profit(users, current, action, method):
	global F
	F=140*(action+1)/10

	def gen_task():
		tasks=dict()
		for i in range(users):
			buf=dict()
			buf['a']=np.random.uniform(100,1000)/1000
			buf['d']=np.random.uniform(1000,2000)/1000
			buf['fl']=np.random.uniform(1,2)
			buf['Tm']=np.random.uniform(0.5,1.5)
			buf['pri']=np.random.uniform(0.5,1)
			buf['SINR']=(10**np.random.uniform(4,10))*7.5/N
			tasks[i]=buf
		return tasks

	def caltech(tasks, xi):
		reward=0
		en=list()
		for i in range(users):
			en.append(i%MEC+1)

		b=[0]*users
		f=[0]*users

		#sum of sqrt
		ss=[0]*(MEC+1)
		for k,v in tasks.items():
			ss[0]+=(xi[k]*v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5
			ss[en[k]]+=(xi[k]*v['d']*v['pri']/v['Tm'])**0.5

		for k,v in tasks.items():
			#cal lagrange b
			if ss[0]>0:
				b[k]=((xi[k]*v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5)*B/ss[0]
			#cal lagrange f
			if ss[en[k]]>0:
				f[k]=((xi[k]*v['d']*v['pri']/v['Tm'])**0.5)*F/ss[en[k]]

		for k,v in tasks.items():
			if xi[k]>0:
				t=max( (1-xi[k])*v['d']/v['fl'], xi[k]*v['a']/b[k]/log2(1+v['SINR']) + xi[k]*v['d']/f[k] )
			else:
				t=v['d']/v['fl']

			if t<v['Tm']:
				reward+=v['pri']*(1-t/(v['Tm']) )
			else:
				reward-=v['pri']*0.5

		return reward/users

	def iterative(tasks):
		xi=list()
		b=[0]*users
		f=[0]*users
		en=list()
		for i in range(users):
			en.append(i%MEC+1)

		for e in tasks.values():
			xi.append( 1-min(1, e['Tm']*e['fl']/e['d']) )

		#sum of sqrt
		ss=[0]*(MEC+1)
		for k,v in tasks.items():
			ss[0]+=(v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5
			ss[en[k]]+=(v['d']*v['pri']/v['Tm'])**0.5
		
		for k,v in tasks.items():
			#cal lagrange b
			if ss[0]>0:
				b[k]=(((v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5)*B/ss[0])
			#cal lagrange f
			if ss[en[k]]!=0:
				f[k]=((v['d']*v['pri']/v['Tm'])**0.5)*F/ss[en[k]]

		i=0
		while i<10:
			#update x
			for k,v in tasks.items():
				xi[k]=v['d']/v['fl']/( v['a']/(b[k]*log2(1+v['SINR'])) + v['d']/f[k] + v['d']/v['fl'] )

			#sum of sqrt
			ss=[0]*(MEC+1)
			for k,v in tasks.items():
				ss[0]+=(xi[k]*v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5
				ss[en[k]]+=(xi[k]*v['d']*v['pri']/v['Tm'])**0.5

			for k,v in tasks.items():
				#cal lagrange b
				if ss[0]>0:
					b[k]=(((xi[k]*v['a']*v['pri']/(v['Tm']*log2(1+v['SINR'])) )**0.5)*B/ss[0])
				#cal lagrange f
				if ss[en[k]]>0:
					f[k]=((xi[k]*v['d']*v['pri']/v['Tm'])**0.5)*F/ss[en[k]]

			i+=1

		return xi

	def greedy(tasks):
		xi=[0]*users
		tasks_s=sorted(tasks.items(), key=lambda kv: kv[1]['pri']/(kv[1]['d']/kv[1]['Tm']))

		for e in tasks_s:
			buf=xi.copy()
			buf[e[0]]=1
			if caltech(tasks, buf)>caltech(tasks, xi):
				xi=buf
			else:
				break
		return xi

	def PSO(tasks):
		particles=200
		#a single particle (solution vector)
		decision=list()
		#particle's v
		velocity=list()

		#initialize
		for i in range(particles):
			decision.append([])
			velocity.append([])
			for j in range(users):
				if np.random.rand()<15/users:
					decision[i].append(np.random.rand())
					velocity[i].append(np.random.uniform(0.5,0.5))
				else:
					decision[i].append(0)
					velocity[i].append(0)

			#for j in range(users):
			#	decision[i].append(np.random.randint(1,MEC+1))

		#each particle's history
		history=list()
		for i in range(particles):
			history.append([decision[i],-100])
		glob_best=[decision[-1],-100]
		
		cou=0
		while cou<10:
			#cal fitness & update
			best=glob_best[1]
			for i in range(particles):

				value=caltech(tasks, decision[i])
				if value > history[i][1]:
					history[i][0]=decision[i]
					history[i][1]=value
				if value > glob_best[1]:
					glob_best[0]=decision[i]
					glob_best[1]=value

			if best==glob_best[1]:
				cou+=1
			else:
				cou=0

			#update velocity & position
			for i in range(particles):
				for j in range(users):
					velocity[i][j]=velocity[i][j]+0.001*(history[i][0][j]-decision[i][j])+0.001*(glob_best[0][j]-decision[i][j])
					decision[i][j]+=velocity[i][j]
					if decision[i][j]>1:
						decision[i][j]=1
					if decision[i][j]<0:
						decision[i][j]=0

		return glob_best[0]

	def GA_x(tasks):
		Maternal=list()
		table=list()
		def generate(size):
			for a in range(size):
				decision=list()
				for b in range(users):
					if np.random.rand()<15/users:
						decision.append(np.random.rand())
					else:
						decision.append(0)

				table.append(decision)
				Maternal.append([decision, caltech(tasks, decision)])

		def crossover(pairs, rank):
			parent=list()
			for e in range(2*pairs):
				a=np.random.rand()
				if a<rank[0][1]:
					parent.append(rank[0][0])
				else:
					accu=rank[0][1]
					for i in range(1, len(rank)):
						if a>accu and a<accu+rank[i][1]:
							parent.append(rank[i][0])
							break
						else:
							accu+=rank[i][1]

			while len(parent)>2:
				a=parent.pop()
				b=parent.pop()
				start=np.random.randint(len(a))
				end=np.random.randint(start,len(a))

				aa,bb=list(),list()
				for j in range(users):
					if j not in range(start, end):
						aa.append(a[j])
						bb.append(b[j])
					else:
						aa.append(b[j])
						bb.append(a[j])

				if aa not in table:
					table.append(aa)
					Maternal.append([aa, caltech(tasks,aa)])
				if bb not in table:
					table.append(bb)
					Maternal.append([bb, caltech(tasks,bb)])

				if np.random.rand()<0.16:
					muta1, muta2=list(), list()
					tar=np.random.randint(len(aa))
					for i in range(len(aa)):
						if i!=tar:
							muta1.append(aa[i])
							muta2.append(bb[i])
						else:
							muta1.append(np.random.rand())
							muta2.append(np.random.rand())
					if muta1 not in table:
						table.append(muta1)
						Maternal.append([muta1, caltech(tasks,muta1)])
					if muta2 not in table:
						table.append(muta2)
						Maternal.append([muta2, caltech(tasks,muta2)])

			if len(Maternal)>len(rank):
				for i in range(1, len(Maternal)-len(rank)+1):
					Maternal.pop(Maternal.index(rank[-i]))

		generate(200)
		cou=0
		st1=0
		while 1:
			total=0
			Roulette=Maternal.copy()
			for e in Roulette:
				total+=e[1]
			for i in range(len(Roulette)):
				Roulette[i][1]/=total
			crossover(20, sorted(Roulette, key=lambda kv: -kv[1]))

			if sorted(Maternal, key=lambda kv: -kv[1])[0][1]-st1<0.0001:
				cou+=1
			else:
				st1=sorted(Maternal, key=lambda kv: -kv[1])[0][1]
				cou=0
			if cou>10:
				break
		xi=sorted(Maternal, key=lambda kv: -kv[1])[0][0]

		return xi

	tasks=gen_task()
	
	if method=='SS':
		QoS=caltech(tasks, iterative(tasks))
	elif method=='greedy':
		QoS=caltech(tasks, greedy(tasks))
	elif method=='PSO':
		QoS=caltech(tasks, PSO(tasks))
	elif method=='GA':
		QoS=caltech(tasks, GA_x(tasks))
	elif method=='FLE':
		QoS=caltech(tasks, [0]*len(tasks))
	elif method=='FRE':
		QoS=caltech(tasks, [1]*len(tasks))

	revenue=users*QoS*2.675

	if current==action:
		cost=(abs(current-action)+2)*1.5+action*3
	else:
		cost=action*3
	#cost=action*3.25

	#profit
	return revenue-cost

#DRL
def DQL():
	Q=dict()
	exp_x, exp_y=list(), list()

	#DNN
	DNN=Sequential()
	DNN.add(Dense(64, input_shape=(history+1,)) )
	DNN.add(Dense(64, activation="relu"))
	DNN.add(Dense(actions))
	DNN.compile(loss='mse', optimizer='adam', metrics=['mse'])
	DNN.summary()

	def init():
		for i in range(history, len(traffic)):
			for a in range(actions):
				Q[str([a]+traffic[i-history:i])]=dict()
				for b in range(actions):
					Q[str([a]+traffic[i-history:i])][b]=0

	#agent explore env 一個episode
	def play(episode):
		global epsilon
		current=0

		for i in range(history, len(traffic)-2):
			state=[current]+traffic[i-history:i]
			exp_x.append(state)

			#epsilon-greedy
			if np.random.rand()<epsilon:
				action=np.random.randint(actions)

			else:
				if episode<200:
					best, action=0, 0
					for e in Q[str(state)]:
						if Q[str(state)][e]>best:
							best=Q[str(state)][e]
							action=e
					if best==0:
						action=np.random.randint(actions)
				else:
					action=DNN.predict(np.array([state]))[0]
					action=list(action).index(max(action))

			epsilon-=(1-0.01)/10000

			nextt=str([action]+traffic[i+1-history:i+1])
			best, act=0,0
			for e in Q[nextt]:
				if Q[nextt][e]>best:
					best=Q[nextt][e]
					act=e

			Q[str(state)][action]=cal_profit(traffic[i+1], current, action, Realtime) + 0.8*cal_profit(traffic[i+1+1], action, act, Realtime)
			
			target_Q=list()
			for e in Q[str(state)]:
				target_Q.append(Q[str(state)][e])

			#target_Q=DNN.predict(np.array([state]))[0]
			#target_Q[action]=Q[str(state)][action]
			exp_y.append(target_Q)

			current=action

			if len(exp_x)>4096:
				exp_x.pop(0)
				exp_y.pop(0)

		if episode>130:
			DNN.fit([exp_x], [exp_y], epochs=5, batch_size=1024)
		else:
			DNN.fit([exp_x], [exp_y], epochs=1, batch_size=1024)


	#放現在的agent進去玩
	def exam(episode):
		profit=list()
		current=0
		for i in range(history, len(traffic)-1):
			state=[current]+traffic[i-history:i]

			action=DNN.predict(np.array([state]))[0]
			action=list(action).index(max(action))

			for e in range(num):
				profit.append(cal_profit(traffic[i+1], current, action, Realtime)/traffic[i+1]/num)

			current=action

		return sum(profit)/len(traffic)


	def final():
		profit=list()
		current=0

		for i in range(history, len(traffic)-1):
			state=[current]+traffic[i-history:i]

			action=DNN.predict(np.array([state]))[0]
			action=list(action).index(max(action))

			profit.append(cal_profit(traffic[i+1], current, action, Realtime)/traffic[i+1])
			current=action

		return profit

	def main():

		init()
		x, result=list(), list()
		episode=0

		while episode<500:
			play(episode)
			print(episode)
			#test revenue
			if episode%5==0:
				x.append(episode)
				result.append(exam(episode))
			
			episode+=1

		print(result)
		plt.plot(x,result,"go-",label='DQN')
		plt.xlabel("epochs")
		plt.ylabel("unit_profit")
		plt.legend()
		plt.savefig('unit_profit_DQN.jpg', dpi=600, bbox_inches='tight')
		plt.show()

	main()


#純QL, 
def QL():
	Q=dict()

	#Q table
	def init():
		for i in range(history, len(traffic)):
			for a in range(actions):
				Q[str([a]+traffic[i-history:i])]=dict()
				for b in range(actions):
					Q[str([a]+traffic[i-history:i])][b]=0

	#一個episode
	def play(episode):
		global epsilon
		current=0
		for i in range(history, len(traffic)-2):
			state=str([current]+traffic[i-history:i])
			#epsilon-greedy
			if np.random.rand()<epsilon:
				action=np.random.randint(actions)

			else:
				best, action=0, 0
				for e in Q[state]:
					if Q[state][e]>best:
						best=Q[state][e]
						action=e
				if best==0:
					action=np.random.randint(actions)

			epsilon-=(1-0.01)/10000

			'''nextt=str([action]+traffic[i+1-history:i+1])
			best, act=0,0
			for e in Q[nextt]:
				if Q[nextt][e]>best:
					best=Q[nextt][e]
					act=e'''

			#Q[state][action]=cal_profit(traffic[i+1], current, action, Realtime) + 0.8*cal_profit(traffic[i+1+1], action, act, Realtime)
			Q[state][action]=(cal_profit(traffic[i+1], current, action, Realtime) + Q[state][action]*episode )/(episode+1)
			current=action

	#放現在的agent進去玩
	def exam():
		profit=list()
		current=0

		for i in range(history, len(traffic)-1):
			state=str([current]+traffic[i-history:i])
			best, action= 0, 0
			for e in Q[state]:
				if Q[state][e]>best:
					best=Q[state][e]
					action=e
			if best==0:
				action=np.random.randint(actions)

			for e in range(num):
				profit.append(cal_profit(traffic[i+1], current, action, Realtime)/traffic[i+1]/num)
			current=action

		return sum(profit)/len(traffic)

	def final():
		profit=list()
		current=0

		for i in range(history, len(traffic)-1):
			state=str([current]+traffic[i-history:i])
			best, action= 0, 0
			for e in Q[state]:
				if Q[state][e]>best:
					best=Q[state][e]
					action=e
			if best==0:
				action=np.random.randint(actions)

			profit.append(cal_profit(traffic[i+1], current, action, Realtime)/traffic[i+1])
			current=action

		return profit

	def main():
		
		init()
		x, result=list(), list()
		episode=0

		while episode<500:
			play(episode)
			print(episode)
			#test revenue
			if episode%5==0:
				x.append(episode)
				result.append(exam())
			episode+=1

		print(result)
		plt.plot(x,result,"go-",label='QL')
		plt.plot(result,"go-",label='QL')
		plt.xlabel("epochs")
		plt.xlabel("Time (hours)")
		plt.ylabel("unit_profit")
		plt.legend()
		plt.savefig('unit_profit_QL.jpg', dpi=600, bbox_inches='tight')
		plt.show()

	main()

def ARIMA():
	result=list()
	model=arima_model.ARIMA(traffic, order=(history, 0, 0))
	model=model.fit(disp=-1)
	current=0
	for a in range(500):
		profit=list()
		for i in range(history, len(traffic)-2):
			action=max(int(model.predict(start=i, end=i)[0]*10/63), 1)
			for e in range(num):
				profit.append(cal_profit(traffic[i+1], current, action, Realtime)/traffic[i+1]/num)
			current=action
		print(a)
	
		result.append(sum(profit)/len(traffic))
	print(result)
	'''plt.plot(profit,"go-",label='ARIMA')
	plt.xlabel("Time (hours)")
	plt.ylabel("unit_profit")
	plt.legend()
	plt.savefig('unit_profit_ARIMA.jpg', dpi=600, bbox_inches='tight')
	plt.show()'''
	#print(sum(profit)/len(traffic))

def draw_learning():
	#QL=[0.17655100614054556, 0.13215352352304918, 0.5113087671194309, 0.7544110766422443, 1.552838777381448, 2.447274122255537, 2.2319735521372257, 2.336694837711219, 2.440184766859992, 2.2480016752641845, 2.596341300084538, 2.6959960382290094, 2.2287442029321443, 2.100534781920668, 2.9471600309912143, 2.657093764779499, 3.5317377695559884, 2.931572943622525, 2.678475470065416, 2.98102490327233, 2.6956148444948256, 2.5424967307838764, 2.6792591720041203, 3.1382158688001978, 2.8557684953617337, 2.7130612390616937, 2.8640535349778, 2.2447303557519827, 3.6241462922388443, 2.675683638348241, 2.2243704153469572, 3.1429475752745963, 2.643062163949253, 2.45891477555965, 3.479533016886682, 3.0339683277208604, 3.1482754365900165, 2.615865344830271, 3.1714758987154616, 2.809235798180776, 2.8172137473503045, 2.948432606666721, 3.045688134505679, 2.3953881771058585, 2.6251742517268046, 2.5696417878990725, 3.036815976272445, 2.863896759011795, 2.3820584305734553, 3.4050571887562295, 3.1641354674199884, 2.9291412708632567, 2.937832417139611, 3.277182924319952, 2.6983587973876246, 2.4673511069439034, 2.7177962336430657, 3.049872479980025, 3.5298603007264657, 3.273434396515072, 3.373879972044591, 3.1769600854262547, 2.936218291362698, 2.9696750446499522, 2.6234595273426247, 2.96603593500793, 2.7611086413002393, 2.8306453809367187, 3.4023562849553324, 2.7226134191166707, 3.254063290869851, 2.5904921675231662, 2.253737240492584, 3.0649163195733693, 2.923473921173615, 2.9109203061871844, 2.697041598027175, 3.1395265492568574, 3.0188810183130004, 2.851183766974364, 3.1366769988115557, 3.3686789818779146, 2.490716704950146, 3.2666780902937633, 2.629935929752442, 3.0589663083297016, 3.0265871061873924, 2.8130124618829613, 3.1850390856468236, 2.4640820858407144, 3.06770286960844, 3.1443109952963053, 2.476362100808477, 3.2809635967938484, 3.1540817994002848, 3.3809698145418685, 2.8277138197576246, 3.258141418336959, 2.823312399247865, 2.9334983336423064, 3.2818772264129326, 3.051697011599968, 2.608984585778873, 2.8047226865065906, 3.2777458150508556, 3.2752349467249906, 3.178908388686372, 2.690929626743369, 3.0504409304150792, 2.8444178881832936, 2.7952338489749975, 2.948377102358589, 2.6053918505194678, 2.91292741960696, 3.4749984212313936, 3.1578578833135653, 2.6972230899470087, 3.3911536732698386, 2.9490304380639407, 2.7104132752751315, 3.4040121007943136, 2.831472150307223, 3.376874142187114, 3.1728475455281444]
	#DQN=[-0.6523628868723325, -0.4785827797526772, -0.6335436765692759, -0.43292914172452174, -0.5415941154064517, -0.05613637265485762, -0.42101306905507796, -0.24708988754334993, 0.18129801268047246, -0.23396758067360204, -0.17451676079142595, 0.43518576561999356, 0.2728377083543925, 0.5189154749218545, 0.20023223340170512, 0.22309001609516974, 0.5469338557654805, 0.47511215803176504, 0.21105078091228857, 0.586083757179739, 0.8161075000879588, 0.8017570395319548, 1.5967902186751033, 2.06192007734923, 3.1402169372136375, 3.7210416323268416, 3.831545923893469, 3.8042087926877435, 3.7923038986716837, 3.6778666922988634, 3.1090152817456236, 0.8042274239483231, 1.8683601520594002, 3.0683672510493336, 2.7503512085362494, 3.291960951141157, 3.5941521010398185, 3.606729870908577, 3.601407581267527, 3.398576190571916, 3.746267801903359, 3.4317970372512456, 3.7574088677850903, 3.4961186486616054, 3.575137953402533, 3.767887756393714, 3.5333760385117565, 3.7930835105288963, 3.5784023664913285, 3.7813564667232695, 3.7405014266931995, 3.2476262706388535, 3.808268753255731, 3.735214576486928, 3.8362947655587734, 3.7057080165978094, 3.254690165589193, 3.0319499619077264, 3.046011741607272, 3.7489718706758013, 3.710363784598368, 3.7009961188553926, 3.6552522228148137, 3.8007955414940464, 2.9770416390258028, 3.071599263390002, 3.7170886798812686, 3.713351808882562, 3.693815713806018, 3.7255601563637066, 3.7195863154049436, 3.6764484442116925, 3.7628909595334745, 2.9554633813045834, 3.484340815343391, 3.687328772658633, 3.6237593056961215, 3.6948444907669282, 3.7732874349834327, 3.660276290405231, 3.780717970326122, 3.797975677799609, 3.6022341039738777, 3.751087598218824, 3.812460076003479, 3.8176898103013137, 3.7402862259069156, 3.684941755622886, 3.7710259637370016, 3.8107391605188403, 3.7138335352646523, 3.7633159880273914, 3.7559796727598234, 3.8084935938225466, 3.844125183407615, 3.760258178063171, 3.8126716255860003, 3.7433309543324285, 3.7618293525496114, 3.845143078946826, 3.8293202449508326, 3.7075387594611864, 3.8349457204784003, 3.688194112487738, 3.8260085970864828, 3.786666611373108, 3.778829393155042, 3.7548916871515896, 3.797850590774623, 3.8439857560679966, 3.831196302676697, 3.827313502985335, 3.804812102242877, 3.800272988235223, 3.7961726446625645, 3.755338519049552, 3.7007516835151733, 3.8510290715863937, 3.81528277051993, 3.801256563536208, 3.7941143507964687, 3.806970785800521, 3.728924363995898, 3.831987344159408]
	#DQN=[-0.7424509151801073, -1.0933351094177355, 0.18331540748530156, 0.325076682651984, 0.3399153344918244, 0.3601003481214216, 0.40179735970372593, 0.4705926067042824, 0.43033612131632315, 0.4284288433404344, 0.4540006875476496, 0.4734054170507428, 0.4890212816871741, 0.52835381938467, 0.496446428955432, 0.4903719890112069, 0.5064076987800188, 0.513124052406565, 0.5009994615625785, 0.5076840047615401, 0.5011640763373325, 0.49261356529549155, 0.48702803383199, 0.4820085849519931, 0.5015696914311196, 0.4897275392621566, 0.5048970849240114, 0.51726254544505, 0.4906353717748584, 0.48832269876742823, 0.48481621689439847, 0.44939888856082477, 0.47933886076082327, 0.47486012538888983, 0.45544502971458634, 0.46167704922264835, 0.4765808908704513, 0.4801669746224707, 0.4616046231444477, 0.4740379605847835, 0.483881415475557, 0.47483223849873296, 0.4417136238003927, 0.4081516559406847, 0.3899767384345545, 0.40421844032136844, 0.4600981794923532, 0.44260921299203915, 0.44531790110165753, 0.44583412349752843, 0.4269654336415601, 0.4487235307988776, 0.41848104410763076, 0.42633093706733216, 0.4133167587930054, 0.4402975417211148, 0.44608840643154724, 0.43929090691142164, 0.4317159737881961, 0.4650554745395375, 0.42379636097136364, 0.43301625012973066, 0.4283019415413356, 0.44205953876430765, 0.42001692958722836, 0.431150577286186, 0.46458543580426676, 0.45189113220217036, 0.46347772581315133, 0.4456473896232688, 0.45919894408600237, 0.44956855763929593, 0.4506987890107739, 0.4404295927940276, 0.4558838531519223, 0.4535417079259325, 0.43693534757906455, 0.446496683896764, 0.4562394693849902, 0.4578953608788783, 0.4452175023127107, 0.442729705933005, 0.44775948114604003, 0.44298028792240346, 0.4456773225534247, 0.452001790964101, 0.44374971483333325, 0.446895612820505, 0.4526780111574026, 0.43174976190230535, 0.44488934383545137, 0.4408981423031804, 0.4518393540089622, 0.44243891778710415, 0.44098079293650355, 0.45201485458498025, 0.45647292497244346, 0.43693289810755714, 0.444782663981757, 0.42996621501922877]
	DQN=[-0.02947138746008154, -0.05683746842319388, -0.5525725638070498, 0.19726149382152897, 0.22128530708781707, 0.3036037727047926, 0.34003872677132074, 0.41055310457342037, 0.39375725485001334, 0.42746250417960274, 0.4446070984764525, 0.46774300000356506, 0.4700197314653156, 0.46670118992580695, 0.4464238472852594, 0.4291272147434949, 0.44531463885560285, 0.42142406907586255, 0.42733233917109614, 0.45640205687050456, 0.4891127714576862, 0.48550703695527625, 0.504642538934418, 0.5006096831218133, 0.5224512252172634, 0.5086412865518086, 0.5347077795638928, 0.5140535884840597, 0.4924636492597764, 0.5004081853506781, 0.4924510359348624, 0.4580505186148501, 0.5329586114353333, 0.46274751206585246, 0.4648217289464002, 0.4750427168052179, 0.44906847099396824, 0.4944624493809005, 0.4663743932079875, 0.4944784744703979, 0.4878671131747708, 0.4777389792744734, 0.46703110512488444, 0.4679160781617393, 0.47190390994900056, 0.49022635757446037, 0.47877212548594034, 0.49376167325890397, 0.502886594206593, 0.49351181246024384, 0.5013959940240009, 0.5012530955848102, 0.5179581645488373, 0.4750897209806199, 0.4687792698219121, 0.45836566181916516, 0.47963627293614997, 0.47757115210858064, 0.484361702308153, 0.5075365425081606, 0.5111625624650642, 0.4937081219119487, 0.5019707314307763, 0.530140681175035, 0.5414122734196177, 0.5125975528275017, 0.517216592435981, 0.45390613936201024, 0.5218980920563163, 0.49605050684758395, 0.5053976354855446, 0.5005441828920113, 0.5206013307361418, 0.4963628082249401, 0.49353865738741076, 0.49535179079224934, 0.5091637014922838, 0.4542242539665891, 0.5192242927472188, 0.5108259981658186, 0.46165206035274386, 0.4880428028477109, 0.5068642042949494, 0.5108471292870296, 0.5121725550511879, 0.5123661737371689, 0.5147528184873763, 0.5119719556752771, 0.5164111630764838, 0.47016850994545695, 0.4961066341159421, 0.49359401568709027, 0.49591550269369283, 0.5109885625020177, 0.4826994566112737, 0.5053097463240623, 0.49694688664014564, 0.49899579937157, 0.4893054634245478, 0.5179297124922158]
	QL=[-0.4766196425382778, -0.418471020937314, -0.16706008478202927, 0.049206965648693986, 0.13193832434336358, 0.21603366329111975, 0.1266303926057101, 0.19176563180706313, 0.3542499022231033, 0.33085973161356286, 0.3214452209473416, 0.41765835412320035, 0.4353572513758351, 0.36045323640995836, 0.393989386689605, 0.3603785336641302, 0.3905742661756861, 0.4526806134919, 0.43721186626709535, 0.36945188280706187, 0.38974434926531437, 0.33151450645899155, 0.40320988681595904, 0.3816447418766746, 0.43615440072494477, 0.42686999252994073, 0.404845224846178, 0.40155735712552376, 0.46681968193140483, 0.4228293300003643, 0.38396543264855404, 0.4187120636645643, 0.42617364049518863, 0.45047809369701053, 0.3599664849087427, 0.48481374806284844, 0.3747897122738871, 0.41155829129070964, 0.4508932586662359, 0.40308882926166156, 0.38349170608998, 0.5452783024123172, 0.4516468007687859, 0.4089639171426346, 0.37841599448898144, 0.41973923178861017, 0.4533736995107233, 0.504196392513983, 0.38115314188135657, 0.47457231120015825, 0.43724443749292274, 0.4315485431778771, 0.4926139885456325, 0.47230222774163755, 0.3672956276985424, 0.44460117520997616, 0.4430498086732269, 0.47656137020789896, 0.5007724879027601, 0.45312281576381935, 0.38298850030431797, 0.4582303237895778, 0.38917972050167887, 0.3593023376617444, 0.4283066032405263, 0.3539809454201628, 0.4413710316303589, 0.39398465020761775, 0.3731257064707326, 0.48317639720131095, 0.4363929309310127, 0.38138892858949186, 0.4442178753599404, 0.45410484871093043, 0.5210105856005565, 0.4810066112278725, 0.4473920963323253, 0.32646953246433646, 0.4480160469899243, 0.42453121384459463, 0.46704570627860237, 0.37206469797062874, 0.3907840162099349, 0.49757067264992433, 0.2944314350829615, 0.4718117440710756, 0.4557667551452891, 0.28925126943433804, 0.36544885963534973, 0.4242225237116225, 0.37686810265200643, 0.35857898244344977, 0.40776926659003293, 0.3840355634477258, 0.5101597693634966, 0.32484278337190375, 0.4212630399091553, 0.43173761768924307, 0.3400797789585941, 0.40224423336247805]
	ARIMA=[0.3117096011976404, 0.32286397511110543, 0.3143966951546908, 0.31861849530784364, 0.3031687759813293, 0.30588246187874096, 0.325659679413659, 0.33356229375231966, 0.32287833186268444, 0.3268157526137328, 0.31808204863734524, 0.32225789428936824, 0.31474065978872956, 0.31749173611109055, 0.3164335350555755, 0.30646404554862594, 0.3313485193874643, 0.31083313434897153, 0.3053184366371134, 0.3186004435714726, 0.3177142204749605, 0.31870526506216557, 0.3242253019836564, 0.3250985926603929, 0.32030705181305824, 0.31693325311976234, 0.31896888896935366, 0.31396874321006885, 0.32280859661704236, 0.31009987779573417, 0.3075871791289287, 0.3249818971712715, 0.31956222861939165, 0.3247740354864155, 0.30885771508217336, 0.3073682334656556, 0.32315688778988066, 0.30638845182875335, 0.3203582872309403, 0.32273599468240083, 0.3108620667144283, 0.3252615318992971, 0.32010974587288205, 0.30993646684830606, 0.31825741300406346, 0.3180360850308953, 0.3142507253404223, 0.3213028478139136, 0.3117135667667383, 0.29476091571015095, 0.3244193203097283, 0.3043777108253898, 0.3180152628697461, 0.31003443809417364, 0.31170499092810316, 0.310888652492232, 0.31839079476295384, 0.32346579875538456, 0.30582101905618386, 0.3203811684019184, 0.30766303138183665, 0.3229853394115311, 0.31096759613034985, 0.30356641666660417, 0.3172505008880765, 0.3202600308757166, 0.3104094456438617, 0.3163369672369058, 0.3084144896581206, 0.32058160137074004, 0.31817269605826975, 0.3233259196199375, 0.30940670183768165, 0.3047358058677159, 0.32653985450378165, 0.31205085256079845, 0.324885214469499, 0.310824225603015, 0.3051556522013951, 0.3196246364000169, 0.30927920543035153, 0.3194376308509989, 0.31102655734662976, 0.31222030085906155, 0.3237088898841131, 0.32032887158826534, 0.32183849903313394, 0.3179086969166723, 0.29538582503414473, 0.3120381412831165, 0.32500015485568573, 0.30927347248139575, 0.315727817258248, 0.31590999267980574, 0.3159877096074667, 0.31444162043133167, 0.3264532168390842, 0.31583978954997216, 0.30466719508190016, 0.3188622406535381, 0.3133840697110469, 0.324420125069117, 0.3222870044250985, 0.3218078786076746, 0.3011665232558551, 0.31438371119035424, 0.3115937108418147, 0.310979118925928, 0.3030046695894398, 0.32039434954753104, 0.31810459270718583, 0.32044442670114076, 0.32175448842716337, 0.3209786169599622, 0.3102311165488405, 0.30213987717416557, 0.313084360908234, 0.309942744266132, 0.30793407772076625, 0.31822960143506884, 0.32013427583026116, 0.31455253170725517, 0.31936636646315847, 0.315154122415404, 0.3201567644921717, 0.30334877395682314, 0.31364403040387656, 0.30503574925544424, 0.3140660361126383, 0.31799242103027336, 0.3140086243251132, 0.3195195974556305, 0.3148721676231726, 0.31494408478021363, 0.3221847969763364, 0.31451196943149273, 0.30090310443411733, 0.3182113981230167, 0.3161304639312464, 0.313801984052321, 0.32906759824505055, 0.32060549729684296, 0.3181912210197938, 0.3117741063288359, 0.32538833333839023, 0.31390627530850007, 0.3171886547760013, 0.3136423220779508, 0.31755156601428053, 0.3111469965830456, 0.31751514089517363, 0.33309609472007473, 0.3124186105786821, 0.3035720229770647, 0.30399587550267365, 0.33187260606106134, 0.3343284169144628, 0.32168867401684925, 0.2998947775618604, 0.31347757892836264, 0.3210958191477514, 0.3097168787511478, 0.32019246690695263, 0.3125656716643883, 0.32582966298720895, 0.30809138696997423, 0.32955878384652093, 0.33427338486747676, 0.3108821780100311, 0.3152878758401053, 0.31607886250741396, 0.3124943290164423, 0.30861963040925683, 0.3139606881772754, 0.31656463772211946, 0.31375257168509607, 0.3068383926541184, 0.3150004007402577, 0.313866897478268, 0.3172769663868278, 0.31632001719271713, 0.30819008527149727, 0.3215132171553613, 0.3199235145715706, 0.3203927663528821, 0.31361286722109144, 0.307216041284007, 0.3184039450502066, 0.32290389552388954, 0.31836355746361794, 0.31729421949211883, 0.3132498197273864, 0.31932615220363625, 0.3179539667683698, 0.3357727113565297, 0.3082443661151783, 0.30686319324505235, 0.3163764804403333, 0.3188376792105408, 0.32067361699999936, 0.32327241791011097, 0.3180426757535356, 0.3178412684872404, 0.31983938758978087, 0.3116564196791503, 0.30897949107258227, 0.31832226859840795, 0.31839045475262967, 0.3221118550157479, 0.32070046478659087, 0.3126096347923299, 0.3138093357551052, 0.3043232526804324, 0.30614193473692336, 0.30761375851904077, 0.3270056929811684, 0.3161536798763092, 0.31136202341453695, 0.3183026456156524, 0.3153955331969885, 0.3162138956231482, 0.31529360698111786, 0.301127038122194, 0.30720577088549383, 0.31620283088911216, 0.31382942538838987, 0.3081249863853785, 0.32721642263274087, 0.32704415112723845, 0.3168513705055293, 0.33315915131010804, 0.31716445008656013, 0.30735600349382847, 0.3165852238730564, 0.31672010354654745, 0.32503917534312277, 0.316318867907688, 0.3151930770201662, 0.3180749524715866, 0.3167481787359923, 0.3164467386203189, 0.31797682357193774, 0.31793404517870416, 0.3199776873306021, 0.31942832717899894, 0.3279930817212918, 0.32754579149988633, 0.30558713984917407, 0.3138912944424589, 0.3219387784086422, 0.3199499068382127, 0.3202743532196087, 0.31140353787000447, 0.31522993131615273, 0.31804082011746265, 0.3158950100748705, 0.3144747001174527, 0.3071990289589227, 0.3196263079170522, 0.3151219282751391, 0.3196698207696861, 0.3221962600275228, 0.32099494273074153, 0.3096639700142581, 0.32538567022119447, 0.30840360237962927, 0.3161095339580458, 0.30966948400965577, 0.3079964874955253, 0.3213270833048752, 0.32331090348193775, 0.30146570680767437, 0.31889214858438636, 0.3267480985110465, 0.3122707702931759, 0.31806222400810463, 0.3023182926228376, 0.3085531836956639, 0.32296927241370466, 0.30573032497940333, 0.3224096822153854, 0.30733611935328675, 0.31701693050554924, 0.3082957706277956, 0.31293064568532636, 0.3250603478598613, 0.32097642721704805, 0.30349883060840976, 0.3255881980458519, 0.32838052827840686, 0.31604210146997136, 0.3144227124198211, 0.3058418224539598, 0.3130593395001476, 0.32190504548672927, 0.3067815612414471, 0.3196869113764251, 0.3158274552295649, 0.31036880785076026, 0.31029100551823857, 0.30403665597005636, 0.31051732262570886, 0.31805851200018276, 0.3085051828160828, 0.32205026958422817, 0.3063667397514432, 0.3053120581115875, 0.31632779708511227, 0.31774944631070473, 0.3173615879433042, 0.3095751522974998, 0.32386556604019406, 0.3093718742842092, 0.3240559161812831, 0.3169287252729091, 0.31652422149277587, 0.3141874967334606, 0.31543121917965594, 0.32258356341290934, 0.32110567745213947, 0.31617197655767554, 0.30721002742767256, 0.3058832741327847, 0.3156216033705598, 0.31396450513635515, 0.3195597515285299, 0.30961603013982286, 0.31934048439190715, 0.30149882901555325, 0.3217407762147607, 0.3155115153868045, 0.3230231160051113, 0.3203913654499389, 0.3065132078457293, 0.31665716418738965, 0.3135837136413665, 0.30142195856856135, 0.3299797858186538, 0.3158079119302853, 0.31632193195158187, 0.30726768864062604, 0.33154908539905903, 0.31517939865062317, 0.3123603254668188, 0.3141853138296109, 0.30980560869584967, 0.31473852034810496, 0.31682087497976136, 0.31569735039962704, 0.31939664992629424, 0.31355565246128425, 0.320139272725809, 0.3144200897921049, 0.3108768581600706, 0.3089555623241024, 0.31140865909979926, 0.3266295002196952, 0.32034948648051914, 0.31365679224659815, 0.32188893990590617, 0.3176190067496821, 0.3221553318703178, 0.32540492949359623, 0.3086399518265666, 0.3135679291898984, 0.31387890801571416, 0.3187220587322672, 0.31974602764211074, 0.31917621203886287, 0.3066501819594053, 0.30846598096186334, 0.3047912947497794, 0.32749538688934104, 0.30876205109732113, 0.3175930129288471, 0.3138315593920695, 0.32277525933266865, 0.2985505851368371, 0.3151070419095919, 0.32311655429090286, 0.33594892817002153, 0.3189518636688351, 0.3132979493797128, 0.32520200267604094, 0.3238254798918096, 0.3199303244582612, 0.32338373084394867, 0.31692583424550147, 0.3105374003893749, 0.30670570645019213, 0.31706984438591, 0.3249481758731843, 0.3178181503534667, 0.3049673740888475, 0.31246294133494096, 0.3183437822994715, 0.31573684271052804, 0.320969509926127, 0.30850159269774535, 0.3238468310735288, 0.3121701890021216, 0.3191044686049291, 0.3163078222858997, 0.3205350163091063, 0.31629766120097497, 0.31596328332872714, 0.32341319857588996, 0.3162565004572424, 0.3264887402210838, 0.32472210742928603, 0.30918195795578657, 0.3104347087936685, 0.30480882995422703, 0.30470784774976056, 0.30927529104039336, 0.3226256125773496, 0.3110293736819028, 0.3054254029003757, 0.32147304520797737, 0.3106128434922602, 0.31973054730786765, 0.32293655704866325, 0.3073377499601766, 0.32204452910558073, 0.32142050208230766, 0.3137379844218473, 0.30948881417544344, 0.31104844155035233, 0.31285487138073903, 0.31814949989664004, 0.31742671084582874, 0.3086008506218968, 0.3204739757380315, 0.3032234660642548, 0.319890142492399, 0.31628153601935843, 0.3159666317182861, 0.32588350232223734, 0.3189617173153298, 0.3246452238473291, 0.3101863648555674, 0.3191124506662281, 0.3149351024049206, 0.32375524936761874, 0.31481335326741355, 0.3134354893789927, 0.32700631488032866, 0.3253071855400413, 0.3150667541541447, 0.3172660647923088, 0.32373156614225207, 0.3203636019686846, 0.30501008374819466, 0.30567052437223224, 0.3121690854091133, 0.3192568931622689, 0.3138159928841513, 0.3093067012279884, 0.31499496533573856, 0.3170664102655218, 0.31639429562176563, 0.32451065836475435, 0.32213653782420926, 0.31394709508937313, 0.3173038057627107, 0.3119294535352703, 0.310307303898598, 0.31471767176735593, 0.31832525914526344, 0.3084721587019819, 0.30970703313497705, 0.31220701053173655, 0.314724900873535, 0.3086606499243831, 0.31194931230692596, 0.3192961507327661, 0.32806029987016233, 0.32004610359583185, 0.31597986386490495, 0.31759518224737177, 0.3110222911208936, 0.3191526239316012, 0.3180690270569509, 0.31649262073620416, 0.3142733632787201, 0.32513016784827303, 0.31179880637162327, 0.3166446586112215, 0.3210576816728765, 0.3210970145617033, 0.3240888006726015, 0.31764886813845467, 0.3249562949292131, 0.3096988517787649, 0.3196169085977292, 0.308125846373112, 0.3145765039129832, 0.32098096099117895, 0.33086949945619387, 0.3096569635643125]
	ARIMA=ARIMA[:100]
	x=list()
	for i in range(500):
		if i%5==0:
			x.append(i)
	plt.plot(x,DQN,"go-",label='DQN')
	plt.plot(x,QL,"bo-",label='QL')
	plt.plot(x,ARIMA,"ko-",label='ARIMA')
	plt.xlabel("epochs")
	plt.ylabel("unit profit")
	plt.legend()
	plt.savefig('learning.jpg', dpi=600, bbox_inches='tight')
	plt.show()

def draw_realtime():
	#DQN=[3.7478759822441563, 6.999778422507217, 5.548162439677827, 3.450772831470989, 7.5488317592465775, 2.450661125703245, -0.3863408771341715, 4.429300066305992, 4.234993667349308, 2.857718649899319, 4.042397307246467, 4.485683365178893, 5.5824538340356655, 3.9413982558620986, 4.612476052135482, 3.808629377794702, 3.9418445021735207, 5.152369699912471, 5.048862900244765, 3.4934367663833834, 4.94643325708058, 4.245860370984221, 4.341827826413724, 3.59691893555096, 4.5137347565203765, 3.5285468420283195, 3.625267044862583, 6.095240161970809, 1.6017200357227415, -4.3859014673196475, 3.7862745119748826, 6.407278498506036, 4.285250512877829, 5.050090073137498, 2.7048408425661714, 5.049697977416516, 4.489854750696926, 3.9369977120515443, 4.355036970565822, 4.833690796701913, 4.4983580203973625, 4.430491520641624, 4.510155476816935, 2.3753233191324856, 5.192926181639923, 2.786136445443181, 4.450384187825943, 3.91221362367852, 3.8995929168466783, 4.3235640053530755, 6.479685121068593, 4.295667847545808, 3.249328820219601, -2.910642459749989, 3.9345538027172613, 3.321249955489108, 4.42038718121895, 3.241347042110334, 3.7910736625746058, 3.812464191285273, 3.223320286480204, 3.9780449868122947, 3.780329035033368, 4.418209608419128, 4.3498591320525035, 4.617495244036999, 4.51826375459129, 4.793148578684118, 3.7515368738961627, 3.331949038397792, 4.255772859144144, 4.415887661876979, 4.222669660846554, 4.131969791098057, 5.980594866047354, 2.3533060337008194, 1.715872426780643, 4.982597109903891, 4.660089109672918, 2.318595485726718, 4.907495772185207, 2.3197707996273538, 4.013214588157069, 4.0256453828273475, 5.099923302753188, 3.8090732017619744, 4.0235872489837865, 3.992920440994986, 5.043102183245668, 4.563600800556426, 5.080275462971585, 5.034121466383538, 4.629162049478058, 4.547174473000458, 4.551716518934641, 3.65583082140819, 4.088057528254853, 4.757259264116531, 3.3053832560195517, 5.707311943667997, 6.215595767370381, 0.401326608048838, 6.633439788255143, 3.5961717575290923, 3.968696581597918, 6.181203176876082, 5.346647029993962, 5.0201939293551705, 3.628432554957094, 5.620435528444498, 3.720536501884711, 4.7809629627315555, 4.847044882661661, 3.8305623001610134, 3.7619454123048537, 4.697334954383562, 4.834126453222527, 4.6379375833769645, 3.307184604419069, 4.036879826842997, 3.11165896430241, 4.709920764663011, 4.368621979049179, 0.5530487544683057, 1.860008644259064, 5.163339275013443, 9.040734481029512, -1.662368629621893, 3.859264217913603, 6.116590922784574, 4.522713331344776, 3.5916697211667277, 5.852234985246745, 2.9968007750186985, 4.904323573484865, 4.677898830853981, 5.512661937208004, 4.71747391252167, 5.798729905329525, 4.748133703591009, 4.240356650792528, 3.9544789113163694, 4.705277205406545, 3.3794937402683174, 3.2561134005349364, 3.6131496017084523, 5.631157332866755, 2.4211241208036216, 7.616914627854759, 5.3870964037895535, -0.36207261890439274, 4.329514160624111, 5.243372622394055, 3.3050490037962557, 4.543353279418804, 4.263941219069254, 3.9517997002722347, 4.649628238382329, 3.864463964259022, 4.0008250566746115, 4.117515083736796, 3.761149087632751, 4.652229752320354, 4.017389356976402, 3.3584756602797983, 4.44581979447315, 3.6156403157997974, 3.6556641168153345, 4.901528597492634, 5.830741728087105, 3.1435606991601994, 4.943057604630718, 6.804095751832091, -1.2345500484544267, 4.013565971110711, 5.454006494790243, 3.1794620045590034, 4.465553107207978, 5.0387226946736785, 4.0161500379647554, 2.783046497236343, 3.7938108953311485, 4.814837311573457, 4.092334373609864, 4.257886496890198, 4.010950333573636, 4.744399457246074, 3.7631350668057673, 3.7228249401660083, 4.294743680634914, 3.3465365071547497, 4.1406598255759635, 5.238773261051152, 2.231152511870877, 0.03156379387101064, 3.3356137928170155, 3.3529232619991842, 0.7016879079875382, 6.003492711950064, 4.520843366223777, 3.218065663987876, 3.613780700170913, 5.787222461253272, 4.065721701074045, 3.9225184289410406, 4.169881112102135, 4.2556507172934595, 4.923238804887088, 4.574520708391531, 4.626986927060104, 4.1081515587144946, 3.4232420673410897, 3.347245248298188, 3.546107895069789, 4.6877785580807245, 3.8459051420512207, 5.333021638395711, 4.265506557884531, 4.912739177761379, 2.9599986269699223, 4.893981114565075, -1.2204733138671129, -3.556071887496688, 7.9362566616428545, 3.3081444485068787, 4.521747859910561, 2.5430547975756097, 3.92775600417404, 3.9741150836201706, 5.486584871790857, 4.56845509936085, 3.621813825883097, 4.097592050717407, 3.89705245138745, 4.520601481468907, 4.250608767475211, 4.271837109466776, 3.332588912096386, 4.874349497979992, 5.737716172625863, 3.717703911122524, 4.64091602526426, 3.0634567138501008, 2.2407872646977576, 4.922127736209819, -6.300441289125445, 2.5441205224744676, 2.6731157014680993, 5.0805134176228615, 3.456491594536029, 2.730098812390125, 4.495454499708949, 3.049561484063496, 4.2138757770153275, 4.923241490331193, 4.840837359768099, 4.000022661073293, 4.2674928947602355, 4.161272597197545, 3.662885999181402, 3.278283502219493, 4.985675417372251, 4.359614339524986, 4.588843584248583, 3.8939389170964707, 1.9483870438542386, 4.7385295638198315, 3.530844880323647, 7.429914855246058, 7.1936514101665505, 4.211266881739588, 4.156518539455353, 0.812225679253458, 2.3600132534146203, 5.356393201555374, 4.621879063124901, 3.511237189696751, 4.582252461824915, 4.132292373306472, 3.231573970753295, 2.9718966183237896, 4.073068463720519, 4.331297474982888, 4.628596959119474, 4.1964130754946956, 3.7111336765116514, 4.4331708535389, 5.463244791241277, 4.4781359135406005, 5.219519496173422, 3.673815553433905, 4.836600863771065, 4.111871243880408, 2.2786738910728612, 0.9385453111585838]	
	#QL=[3.6900319530886763, 4.775709262603278, 2.058955287124627, 6.759817738205567, 2.2590018325061214, 4.799927498995722, 0.895024972382919, 3.7655176614372214, 4.258441158828534, 2.8036651914957114, 4.769085214174146, 4.286231801189038, 3.868380704689897, 3.5737114444478344, 3.1329719057347782, 4.484344007899755, 3.9856236727964354, 4.468709039941571, 3.5953856967460904, 4.254287987397485, 4.432482182339793, 4.334961260820689, 4.138297098185323, 3.940146574402139, 3.2353319159945233, 3.077414031483899, 6.94367917553574, 0.48931318043456384, 5.403376991546247, -3.82060262140683, 4.48509902994956, 1.3091242214847074, 2.6823178748509524, 2.8579632623628233, 4.1735370152002655, 3.984745291765248, 4.40261729174056, 5.144888576962592, 3.8971383638415706, 4.3879182656449744, 2.6664972086047114, 3.822873913194624, 4.790071697042243, 3.043907103011408, 4.75846395976542, 4.827056420262647, 3.354930090967629, 3.755264411634561, 4.0613563889177655, 4.831264473881276, 2.8282992710216917, 2.1582383713795794, 0.55595709312172, 4.703659852541684, 3.476680205000829, 1.7723943821949162, 3.307917227651077, 2.363108450094918, 1.324325574081993, 3.9891061604235953, 3.545107441311263, 4.866135797103568, 3.3052751816557917, 3.3988993209374807, 3.8162094442012444, 4.563650785691802, 4.372787011041946, 3.760367841827433, 4.3862604251569195, 3.1477594278303176, 4.2626974064003935, 4.500773412685558, 4.8062158091447795, 4.067502778915313, 2.9294248493361468, 4.740097481640375, 7.045715931881706, -7.65897634932492, 0.459631612463518, 1.1600443011853687, 0.5773902694342595, 4.49915046090072, 3.9074814139484326, 3.6554840192168623, 3.9444985381146944, 5.171411343475884, 4.815610933779974, 4.111041691116649, 3.9772249620126003, 4.912955225116587, 3.7185256128827398, 4.342992998270896, 4.811735859696107, 3.82334934718592, 4.764304133166892, 2.753559239763209, 5.229271835753344, 4.02122437029867, 3.037506337556849, 3.2742033155535695, -0.06678170112619597, -3.3433595688292805, -1.3085351360416784, 0.6376295612593191, 1.9554600072751647, 4.364958478130024, 6.007535916316205, 4.114065248243412, 4.62659292498466, 3.5956983968834124, 3.3515743678480536, 4.87046647388706, 4.04910233814043, 3.6372196610604814, 4.013164011843601, 4.36544801492567, 4.337783810887455, 3.1478241084383316, 3.6169825762645758, 4.69112293643836, 4.738194544781986, 2.528252825039516, 4.470111373399105, 3.004764143585534, 2.6923200684817297, 2.5647372773979424, 4.758401512047461, 6.186526198954894, 4.371474073090109, 2.2567546577621136, 3.619333514218427, 3.602053626955189, 3.4231768720511906, 3.663532890964575, 3.3152193327545123, 4.210129914879337, 3.8162997588416143, 3.088482233734242, 4.9613163299864285, 5.875360422250397, 4.081465073837477, 4.48196585298317, 4.364814809070934, 3.843215456479595, 3.3395633195981635, 4.058309683216895, 3.486448639226147, 4.490361253746815, 5.601926952224347, 4.7640293758673575, 2.4763540599372345, 3.233388914280235, 5.792326810874242, 4.644024672223066, 3.656470707613693, 3.4884328627036614, 4.539901488947464, 3.9128799762071402, 5.68611543862824, 2.8708953601222196, 4.8052751294043485, 5.840668266371718, 4.938301802534939, 4.968435559631372, 4.923019408293614, 4.14949670943622, 3.9931059058231373, 4.255245014789371, 2.944892010526588, 5.035912630393835, 3.9471398087609217, 5.106366552113263, 1.9195944481102956, -7.81465543233861, 3.4944275460186875, 4.224433949017424, 3.4086897979917405, 3.430529882759064, 5.220607762127849, 3.379570836009364, 4.3673208139256925, 4.539889419620695, 4.671560770415783, 5.321050967400438, 4.68512525894376, 3.483990402006793, 5.276035925333903, 3.8663832071284983, 4.412758488163405, 5.382195330581693, 4.342019848983269, 3.8780272160119487, 4.381512667646557, 5.5854356163260945, -0.14989752723189062, 3.4627374966832876, 4.375565932591492, 0.20170827124888646, 0.9330343391224473, 1.375651905605009, 5.001999835098432, 4.875654141675295, 5.171765720203316, 4.948944767074587, 4.590596665512673, 4.00102002846041, 3.7753241517702456, 3.9070111091716306, 3.4610411978441618, 4.721934277315938, 4.0548995180412915, 4.543628416821062, 3.683626388414429, 4.268209336816416, 4.088542077818489, 3.864674741037309, 4.517383685638777, 4.837153867732049, 2.3128547012637073, 8.654913712963614, 1.3849401064651403, 0.08512901290392616, 3.528771778124537, 1.3227973947536407, 5.00878562179303, 2.649108047469823, 3.1120369223550473, 4.612813122331579, 4.958101021844854, 4.083146862738007, 3.73005492396857, 4.596205354186765, 2.6813625329089414, 2.6650670755256747, 4.07874366402635, 4.387771595825264, 3.7142524567779285, 5.151395519950916, 5.1098280619165655, 3.5385616194997063, 3.6961624362486165, 4.3313333537390895, 4.475003650150117, 4.599155194571802, 5.1476694394559654, -2.85167305885993, 4.71707614892349, 3.2837995782650995, 5.489647387710449, 3.792716041286879, 2.0011558461466166, 6.686819882334086, 4.963381978988917, 4.544985444777433, 3.3215193535884397, 3.7913226072748007, 3.969392862294063, 3.4520157448052537, 3.271973301914269, 4.397761039665717, 3.9465059365958215, 2.947706063292195, 3.636313409752578, 4.4902027814924645, 3.651928028792224, 6.004531825893255, 5.157473805042618, 3.485377620445199, 6.749082792297, 2.9140378843624544, 1.239654589863198, 3.74191344926499, 3.1063875576377282, 4.349368287505761, 3.6923849175076993, 0.6413413576331001, 4.703558065812736, 4.244156753614123, 3.0563679548911966, 5.214048319055698, 5.037089368232961, 3.455099882476514, 3.0765623539844285, 3.9607432202970867, 4.254462020811061, 4.194693892920255, 5.067161775409003, 4.110567926515908, 4.307667109636327, 4.635205662225223, 4.5065391868468945, 5.129322694976365, 7.260308011846801, 7.741523645488411, 4.513482284999546]
	#ARIMA=[0.6610388389349553, -3.18290980761241, -2.065267060567571, 4.975306007402995, 4.495786950743253, 4.119521118984825, 1.4528451376485012, 4.9423798625731195, 6.54095262288449, 3.195042499696752, 3.8883270500624016, 4.11816586353287, 3.993225026465857, 3.423961894976453, 4.941064723637692, 4.090074068458416, 3.4610766039498007, 3.5192774592551475, 2.427118232756055, 3.954603411117278, 3.4337770374782237, 4.571813704181799, 3.8365731056056513, 2.0826406988968413, 0.19177050084873315, 1.2307989180150258, -2.503861598385297, 2.354858686398692, 6.6474790211253385, 0.45891294101646807, 3.1923349242468766, 7.622917293730248, 4.72087803035359, 5.167627923249424, 4.21436208667838, 3.280361619465284, 2.791271772627605, 3.995535527155988, 3.0386501066192992, 2.996274409886819, 1.6322343930021803, 3.0807840848285766, 4.0764069657837645, 4.537665074719713, 3.4418575058750123, 3.3545618128934356, 4.019054194956686, 3.1372215926341855, 0.3677707187684909, 0.2924650325946465, -2.9720698107620698, -3.7129594828960295, 3.2560423037562054, 1.8066148159042, 4.479999017697762, 5.517516919618558, 3.8111762612346527, 5.201141265879393, 4.935987013312639, 4.383755997626178, 2.314631341118922, 3.9395982004473167, 4.56577724137751, 2.8010704582301433, 3.7619496019462857, 1.3046510610630102, 2.882750775776203, 4.483517943700383, 4.108465116165731, 3.3056155342527322, 3.688559456183431, 2.2577238167876845, 2.0247995192946826, 2.0277031190086903, 2.519031722494316, -2.855466034275679, -14.05879320816462, -1.686922278446719, 3.4996854137826405, 4.736456241683088, 5.3521344008672065, 2.3573547919944735, 5.798860100737873, 3.5751659081988576, 3.507192128278196, 4.442649488332907, 3.9178849055865728, 3.669432790762621, 4.361874716599207, 2.581043449754202, 4.620368997336861, 4.0777831411678465, 3.604784732146061, 3.6762379001865364, 3.540055662063012, 2.6866276212731375, 4.193990957685084, 3.3028607106421055, -1.019957299336921, -2.6281641469826127, -9.056799092716087, 1.432233763444282, 4.575746128106285, 0.8563466063699643, 1.175704862495478, 3.8124730653867798, 5.03213480856872, 2.880021063897514, 5.535718690481163, 3.502788107633903, 5.19658082417514, 3.8717894991708146, 4.132651947975504, 2.78160619690792, 3.862074279989697, 3.9186695717537856, 3.2304258276585838, 3.7798003825234954, 3.7920063428472877, 3.104336331735376, 2.3578502892046607, 2.472377115363483, 2.1801281169746014, -0.6868780323030504, 0.2767548868785079, 0.7157728867020529, 1.002005227250553, 7.723031168278816, 4.4184864497688645, 3.308770163572067, 4.74759371264799, 3.719303322604447, 3.192278558635963, 3.228269528014556, 4.416772852546608, 4.53251716704804, 4.306081039795362, 3.6303566390547344, 4.162599501932976, 3.8803032927877843, 4.213885404579707, 3.312085580141757, 3.4682560136249214, 2.9948470060705183, 0.8336214079174122, -0.7248397469503747, -0.6718365694979079, -6.473726948366437, -0.2047324112157396, 0.06920006030961252, 3.511640281780197, 3.8577771592403995, 3.1841993539359836, 3.779268715010906, 3.297309326118768, 5.211334237989174, 3.983838406846038, 3.9885624293444404, 3.9056243866061573, 3.626168079342595, 3.837470452942706, 3.443043621499873, 4.9686320261346175, 4.331057209227177, 2.8870080229947903, 5.040105830789436, 3.929875816773124, 3.1038790414972577, 2.2461359156769447, 1.22008353393515, 0.3641311627764239, -2.8341999362573334, 5.210758032586685, 3.373227171880302, 6.1572923944093665, 6.662082131076448, 4.131256534466125, 4.639390805389736, 4.315618052295707, 3.9616471944965355, 4.689537590527494, 3.3652203907975338, 4.606902331529322, 4.296558236752774, 3.4315789650969015, 2.5328308172795655, 4.377711817407924, 4.977504473873359, 4.575918345390846, 3.9297304279111858, 4.365511795894399, 3.692054800464448, 2.391632245768177, -0.3237641302990923, -1.3728693466536015, -2.095734934262532, 0.12012655800735228, -0.6749913273727244, 7.614414161156806, 3.986352229513645, 4.419841163444183, 4.215812821809766, 3.1750667673831443, 3.340353906049101, 3.8000662326703494, 2.2458330352498757, 4.318286956906892, 3.843532720943869, 3.793362581028296, 3.3124501635069072, 3.251664627318838, 3.7387907280547026, 3.4821723903829493, 4.407785719880603, 4.577418302468237, 4.3487394969055355, 2.293314123902418, 0.43261240344832785, -0.4409407268005613, 1.3278961300584673, 2.1398110102526586, 7.308055341251877, 2.1096949421505684, 5.264830646082998, 4.1882267956135655, 3.84367800402062, 4.660481469876277, 3.3089366610929645, 4.251652491246595, 4.512936094554114, 4.947480906538135, 3.25136489574769, 3.687885352824, 3.173041648253499, 3.787580731682696, 3.0851736776431986, 3.4908672133793504, 4.294886093453144, 3.143195994243251, 2.8570263718729683, 2.3728303822844063, 2.107073778845143, 0.8620240715526902, -4.612787323780074, -1.0145387996056812, -13.397161402955792, 2.1693327914899667, 4.96974682240745, 5.806889737271878, 5.503827043668822, 3.4379696357551834, 4.149784093007825, 3.4711430428228613, 4.381525750266958, 4.607351067690533, 3.7727688467067955, 3.915272047777017, 4.31490533725118, 4.231603095668144, 3.707727021094821, 4.011837782450765, 4.244148866993828, 3.888235352867197, 3.181827578196691, 2.6068741840993384, 1.5621032998321691, 1.5244510050119293, -1.4181045289549432, -1.8303639125701152, -2.7027650220603405, 2.2141015618877646, 3.4828743716168518, 2.0571206488251383, 3.778160639443148, 4.751558553457791, 2.4801672045895913, 4.095889202365985, 4.4572639064014155, 3.1866064835110186, 3.793121176394976, 4.308278549996827, 2.4775649659787184, 2.7875579084618773, 3.7597017522346454, 4.09199700126826, 3.2719241680590994, 3.6715713854481424, 3.2945199869687594, 2.2756758870640237, 0.9735482728744103, -1.4400803867917176, -7.956044746036151, 6.071440019415945, 0.23480777321886723, -7.223271211974792]
	DQN=[0.8060586959378827, 0.3130093484284287, -0.6423864373765538, -0.10187484250873435, 1.1657026782365092, 0.24854634744473683, 0.7739357357747698, 0.341763497618662, 0.8060341776570276, 0.6975861812926877, 0.5717738781765602, 0.4706826542533455, 0.2762538980837004, 0.422080690337605, 0.33747142190633894, 0.6291148860649809, 0.4566732304145035, 0.5436056597477196, 0.5740012036100262, 0.6836540663023437, 0.5561173453965503, 0.5343391036705084, 0.3953659522575778, 0.5818830184683664, 0.46121492089175287, 0.17093661612652303, 0.7922873657353365, 1.395492680879536, 0.32599403644260083, 1.2033337575633756, 0.7914166967663959, 0.6106878710126574, 0.6083407925019533, 0.48622272113309295, 0.7015685503821696, 0.5294681083597991, 0.4925081567513977, 0.4741645293729084, 0.5890254881846692, 0.44505040788355993, 0.6366783520465621, 0.4481864439033628, 0.5765044618343081, 0.5185498120312726, 0.3244075500826875, 0.4921046554599114, 0.5186114368617171, 0.5084926734214243, 0.5218544202426345, 0.5890333067905088, -0.063257518802631, 1.0815611633345035, 0.17131660236813331, 0.20519077549933185, 1.5253714548607178, 1.0773612429532324, 0.7125815177619464, 0.6800021862465889, 0.4877307089561706, 0.4827244743487924, 0.5514416665625641, 0.36657020327872014, 0.5325619171728636, 0.4113927889402465, 0.5101720069826581, 0.5512865479908338, 0.6938357787581803, 0.5516196684911946, 0.5744684881859066, 0.5137248115342212, 0.44546899387062744, 0.39849767458190455, 0.4612196631503426, 0.3991794768868409, 0.5964260437406914, 1.2825335407480336, 0.14601788873675114, 1.3644243962519815, 0.5509657913953956, 1.1691016095297468, 1.2246986692082176, 0.6478462894912778, 0.502515753377663, 0.5331721304087524, 0.47633509606601043, 0.4242721747328665, 0.5181326123565058, 0.5013275652296978, 0.40323368752168504, 0.43410440558442037, 0.48257571020049667, 0.3446777911415313, 0.5434027855021231, 0.5322036590886985, 0.6294891932740937, 0.4935672993637725, 0.5725442769953153, 0.39093188104055965, 0.3742358504608601, 1.0058473928176488, 0.5039763151197402, 1.5938096210854416, 0.4622153790124979, 1.4177524961769044, 1.1017011522559945, 0.6520394587898292, 0.6140439483525131, 0.3929769301489985, 0.6181105259807294, 0.5369606981080752, 0.30219990033271843, 0.47414188170727917, 0.3744380166971796, 0.6060186634063036, 0.5907356078683001, 0.4740518222945278, 0.5234670339260382, 0.4379246444427572, 0.5278271316009426, 0.5289989199380332, 0.3498645899608061, 0.5438755514959481, 0.819117373190113, 0.9504941241676779, 1.3069459319214207, 0.8730077388948881, 1.1848617557871022, 0.5460362159672528, 0.7353087632453648, 0.695653019957069, 0.5019867895906812, 0.4491542392739212, 0.5303352514095789, 0.6368936354934231, 0.45897333747358865, 0.34134394623852554, 0.4426270447823434, 0.4533797204130809, 0.39645606244220993, 0.484525272268526, 0.5058883950188978, 0.48215550950388236, 0.4529435234543183, 0.44442761230387295, 0.6638289541618076, 0.4678558621548301, -0.4794121062895342, 1.6531863611755082, 0.4108968807802753, 0.6032440818168977, 0.7135981219044402, 0.3672511926068876, 0.5600802985024178, 0.5918461203228866, 0.5891614692973838, 0.5350147546909662, 0.5334530142036977, 0.5360312210426651, 0.4978896894589607, 0.42635135738412716, 0.2399599194825125, 0.5370428558319301, 0.565108248720981, 0.6500043854670849, 0.4576737833865728, 0.446534684619203, 0.3528379882730013, 0.6684468567864476, 0.5975438514978405, 0.32946046833017084, 0.6570737348025588, 0.639925227532944, 1.4105317840957126, 1.706986621341239, 1.7602646301048488, 0.9461400275370965, 0.34907999337290124, 0.6127621024419113, 0.44533580026694913, 0.5645863640039726, 0.4773989342292705, 0.566645177709749, 0.4971254752727418, 0.43958853951438653, 0.46846678138416464, 0.500977759915036, 0.5251061327510637, 0.33911363111596304, 0.4065050546134748, 0.6006237695658088, 0.3737904741843507, 0.45615635014512107, 0.4615748624038474, 0.6965108480748613, 0.2500773175409747, 0.44660592920415604, 1.0684621826166043, 1.7582388511198082, 1.158933591403344, 0.5601764094291939, 0.882568884372344, 0.696663914804892, 0.6000730151758247, 0.43465681662014866, 0.6380661694859902, 0.4967492949318131, 0.5694303143703, 0.38998023986402136, 0.43758938615641557, 0.48594460941061, 0.5874922283912718, 0.2868205210215251, 0.4644833460339396, 0.46838471604672194, 0.3633148791663168, 0.4124830859330881, 0.7107787102532411, 0.5531541658444498, 0.810270585779011, 0.6029560284890851, 1.5814331341574157, -0.21855526511610424, 1.7484725043580427, 0.9119663620226239, 0.7095513341955434, 0.6737377211008216, 0.6128411899133375, 0.512213282896523, 0.6471918286594761, 0.42898787957709417, 0.31943790855172366, 0.6141204793862592, 0.5683143098120347, 0.6494857694248516, 0.4062295110547077, 0.5581966073805014, 0.3688339846609929, 0.38926224656925534, 0.3413105184806934, 0.6232609241025158, 0.5938396998545409, 0.7394264488378308, 0.6169538654210444, 0.35025839621139543, 1.608325452391717, 1.629241503225968, 1.6679180614736253, 0.9389129881160668, 1.0036536859569294, 0.5674641216262076, 0.5661009702369117, 0.5307313615737691, 0.6485304962519052, 0.39376959489388974, 0.679839847019162, 0.5479391841364952, 0.6021050406663646, 0.6748463452060433, 0.4775676800124247, 0.6617428599258003, 0.4683144067165406, 0.3875822295187524, 0.3475709479499534, 0.5682362123599363, 0.5772497147665973, 0.28184912631128894, 0.6800960717226403, 0.5405247980321981, 1.206209278155668, 0.23840886374267756, 0.10947365679364385, 0.6107371354840702, 0.6627312345782105, 0.4851025017599019, 0.6506113679940086, 0.7247356361908909, 0.5082813122499347, 0.3866119823416438, 0.43143812194484593, 0.47097106077257644, 0.456705059956724, 0.4562873906631948, 0.41391614215385586, 0.4498191214898362, 0.5179323149831677, 0.6035761120700395, 0.32305239221081133, 0.463378435201207, 0.5583091930239723, 0.4158593027217382, 0.25214107080428255, 1.318303372234128, 0.6871936738856945, 0.09183025928514343, -0.4521418717118895]
	print(min(DQN))
	QL=[0.479911649801819, 0.7488551687718297, 0.5759977313742697, 1.353576635795081, 0.44845151651655013, 0.4508645833763456, 0.19667961205906068, 0.8405982361840145, 0.8102760009437535, 0.4254839650120841, 0.11345744440269386, 0.0790487685279261, 0.21334090401682596, 0.4395936644104818, 0.28325772137186206, 0.47664146971005117, 0.4703088063644136, 0.5645730969328192, 0.43676217200483297, 0.4449140822036896, 0.27231499718320473, 0.28551048151322483, 0.5816900841347171, 0.5836650700705033, 0.1389398961039241, 0.5901976088548949, 1.0187432500350366, 0.44325107662522534, 0.586631879658106, 1.5736364298377288, 0.19824508078989123, 0.4919755380924453, 0.4778964442929346, 0.4845535495334798, 0.6036199392612197, 0.1901494774730431, 0.6156901733171036, 0.42746000790679173, 0.30840507224297553, 0.17341255500053665, 0.17142970383765915, 0.4478424217056829, 0.4889314419152851, 0.4791330449198277, 0.4521988210338344, 0.09922461412962098, 0.3434841213391349, 0.5005630428202129, 0.6020066526701907, 0.36367200105986347, 0.88832058036512, 1.464635912667937, 0.397245530467442, 0.3661107089549691, 0.7564735085658615, 0.4332305678899931, 0.4552881917222038, 0.5496720566317039, 0.5548636305187965, 0.4733274859214826, 0.399864037321505, 0.22410214694012193, 0.5321729062795293, 0.3653244278098357, 0.5709698864802347, 0.608318451053658, 0.39403461452615, 0.3671135551636438, 0.41812059154357223, 0.4177132737833851, 0.5815190145725257, 0.5395291187367112, 0.3727257669198359, 0.41922045931993934, 0.8631302459663711, 0.53261230888438, 0.723356515163252, 1.5000199996504033, 0.0035432224076743513, 1.5236100487558715, 0.13004883363928896, 0.7716968812573304, 0.5537629148755047, 0.6735814098800884, 0.5573033879206026, 0.5141409949688354, 0.3394582451593076, 0.5026966136596668, 0.623052191706932, 0.5102863835577444, 0.2907543860378272, 0.5077647908001127, 0.5440859450658221, 0.5198014075628752, 0.2665013990382338, 0.619583602454245, 0.4221078457240291, 0.045589577937831006, 0.3605109786105614, 0.08852168160866232, 1.2059493583175493, 0.7815350788457827, 1.3832538437133848, 0.7361095865350622, 0.22817067984683653, 1.0117880236896355, 0.733950960109854, 0.6387669877949539, 0.4727372145707, 0.4195274347821396, 0.0786298253224076, 0.37404024160977756, 0.48307798284724157, 0.3697975543787766, 0.4079301132836335, 0.46831007980163314, 0.43265618654217125, 0.45327100810369697, 0.33199020362840115, -0.11650343856506606, 0.6368217476604678, 0.16162033337333864, 0.11743180654475739, 1.1376667427855198, 0.06936366219275092, 1.2797402651754102, 0.4843894853368494, 1.1121692936276504, 0.7748432267434978, 0.3253465470485591, 0.39255995747533257, 0.6619638342925867, 0.40178202413692915, 0.5556825006807704, 0.6596807720455086, 0.3774282540951142, 0.5504251956233065, 0.521757561413841, 0.5226399906282452, 0.45327493968854465, 0.3734153658455696, 0.4497353432031037, 0.2352911262233793, 0.5928551834434121, 0.5447902981134334, 0.41103253457294486, 0.5895764948172911, 0.2025781417514588, 0.35419972861739524, 0.47908032436370185, 0.7466567149135006, 0.4141944716443436, 0.633559823230502, 0.37975563739637974, 0.648807930060359, 0.33795456168480986, 0.5854418133858508, 0.4340418414941287, 0.4219656117409124, 0.5284451314532569, 0.5550272118338637, 0.3732767633603439, 0.2685002087566975, 0.606428649958463, 0.637241267851783, 0.37515098188882806, 0.4889493218745431, 0.5287153123147231, 0.543874657133221, 0.6853515110515538, 0.5490772286088957, 0.6434868357114537, 0.41002706289307445, 1.596269261139716, 0.5254344999123903, 0.07809084218356066, 0.21631796893122512, 0.7325824376714816, 0.6692935574832048, 0.5435678331790457, 0.13101099103088648, 0.4081690066379498, 0.18399789851731294, 0.5832008462619882, 0.4003179135330192, 0.5219190622196647, 0.25311224010408945, 0.23252005785468796, 0.5429276216403051, 0.4445589239052052, 0.48860195992413435, 0.3970761622488599, 0.5624791969633481, 0.5397527167998325, 0.6894946453267464, 0.6205046631388045, 0.14933788635335765, 0.07023586709442475, 1.3301978275165154, 1.006385824282246, 0.7728173259352938, 0.6517912581478179, 0.6809117393725863, 0.177550833338853, 0.6057967571032593, 0.21630496750213418, 0.43965308878235665, 0.43784863105421284, 0.4461830122887574, 0.5829006287792128, 0.434392262237266, 0.34018162592237217, 0.37748266625957183, 0.5939177940971114, 0.3483371967406183, 0.46503564392622804, 0.42115447459357763, 0.3016762921746456, 0.06602475332304866, 0.5565264379672031, 1.4216109791442275, 0.34879733680661396, 1.4757335805931273, 1.194756791116574, 0.7525338045521269, 0.3847470637467524, 0.6829670549255367, 0.6573001814151732, 0.5824911153183623, 0.5219288901816568, 0.4582109595438033, 0.6751461335722945, 0.43301984926523707, 0.619493099358046, 0.47587463276948694, 0.5282589402140643, 0.4730638433748389, 0.5305663788983964, 0.5206901184452486, 0.5698805862672474, 0.5848477911640396, 0.46414125423495195, 0.857319912151642, 0.7709209227604367, 1.2343997056543456, -1.2855644587725212, 0.24701015271079885, 0.5452061668701683, 0.9342391249295152, 0.7411042576748006, 0.1571730260639253, 0.6007743553867647, 0.5549598434895531, 0.4735844501349259, 0.4854289666930904, 0.30205810064893707, 0.3319050417305593, 0.5973019389514487, 0.43324816683178563, 0.49160936958315876, 0.1746478097517186, 0.4151592671254201, 0.39885256631558164, 0.43939682973875094, 0.5597505515687748, 0.11023866626565655, 0.7498056467704679, 0.6640386948535478, 0.9823580941742224, 1.5622836413707914, 0.6738422064273207, 1.4779020571795263, 0.4653939971127355, 0.2764341842397261, 0.3070656576722226, 0.5782130010323921, 0.4198572753510957, 0.2540745846722762, 0.6084609324043411, 0.4352060794133548, 0.3756424547030375, 0.4941428831911894, 0.4559224060422614, 0.5252878387877791, 0.23806364009865402, 0.4621201425813565, 0.2725174695309031, 0.33483477928480343, 0.43514618682840434, 0.16291464737377453, 0.5082475259429605, 1.5622976469467875, 0.5669267569797176, 0.17417055711568588, -0.1488262467138375]
	ARIMA=[0.5455319678584408, -0.1265016746390876, 0.6716813886950451, 0.7330072666803593, -1.150461148948776, -0.27830250169643617, -0.40160333214140503, 0.4293944808433002, 0.5925765472453001, 0.6326656195118414, 0.5116066736712988, 0.5746951761701602, 0.6041969325467478, 0.6242660440569825, 0.4209612177496638, 0.5991410677570835, 0.4717955440793602, 0.5892596182420822, 0.39391239257382593, 0.6041608499802312, 0.4248465941563376, 0.6159187864922218, 0.4370987516242025, 0.40778771730664176, 0.4412555299327888, 0.47121256214946755, 0.39412938813438714, 0.97390337449895, -1.0448986303223502, -4.76116061500878, -0.45715651558917436, 0.3322630709632432, 0.6469670516461966, 0.5318542943614206, 0.4029361981395098, 0.4827584719059982, 0.47954745790133185, 0.5179488524586108, 0.4651804483364931, 0.5712613814236495, 0.42995523109062456, 0.4303889810227195, 0.5581383753100978, 0.4739327869073416, 0.4094938450624479, 0.4038163172487519, 0.4757942899945306, 0.5343327022884345, 0.42259431060427766, 0.31090439156224836, 0.23396058217784857, 1.0567610026829475, -0.18178452869716585, -1.1077507764144352, 0.04527685840253722, 0.320297234665436, 0.2888492118826737, 0.4186679655292872, 0.6424270523223883, 0.5204150718902792, 0.5590551082626085, 0.5381089880938049, 0.5980776507253508, 0.4772028185224156, 0.4476419834285787, 0.3665012856065457, 0.4429186144653971, 0.585177378469991, 0.5600260868862968, 0.4671598618909773, 0.4163053451441433, 0.5135693871437915, 0.5906346103749357, 0.5806338245567572, 0.7690077086925091, -0.48137415216062784, 0.07049203016128147, -4.335579872804619, -0.8218942050264579, 0.11616352207733205, 0.21968023997306974, 0.616705081482344, 0.4397748352094155, 0.6431620160181949, 0.4141532260722881, 0.496803362295317, 0.587380006979433, 0.4721759766772805, 0.34668265388571484, 0.4344843214692906, 0.630673750604766, 0.40016717226942333, 0.3382122405403213, 0.38714147710224656, 0.5179186958831613, 0.396256959267905, 0.4922437399525405, 0.6221232896787974, 0.29493227229489577, 0.4586579014645622, 0.6244164836852167, -1.4429579321572226, -0.8165287659985969, -0.27767291690234536, 0.5704622586144197, 0.7070053810370251, 0.6533479958137413, 0.46224199649826914, 0.5445563239447426, 0.48655764579488625, 0.6071813522482932, 0.49497715810836324, 0.2978692938395992, 0.5267349316570716, 0.519472532258508, 0.5585856679724077, 0.3103989712350466, 0.5513833141616827, 0.40788912781449926, 0.39243816769903633, 0.4104680210408542, 0.6206894864720001, 0.8143944716057969, 0.6158672860699633, 1.1179385949648413, -0.2687787290960779, -0.3176563844579527, 0.47304542236011954, 0.5605491031022369, 0.3932454458631451, 0.7416118054049677, 0.633379848894889, 0.43782778552414026, 0.5661152544932866, 0.5552637282214022, 0.4195222229556267, 0.5772779381698231, 0.46332828543680865, 0.4566986186164787, 0.5923632619995691, 0.2632989735117784, 0.3636670252174256, 0.25922539794743155, 0.537497097999659, 0.3526958348909375, 0.27508152591026214, 0.680852552409569, 0.41600040374881403, -1.3080836349532832, -0.37316671123305767, -0.2814513355906234, 0.5227930733496308, 0.4258464583942263, 0.4777401424365401, 0.648867083354741, 0.6464751181900212, 0.6139830721653168, 0.5240893638252576, 0.5120512888046497, 0.41342364101293166, 0.44922013083691786, 0.33031613121700965, 0.4906632882779101, 0.5163337750287594, 0.4591600065418947, 0.400041823677337, 0.446994431769524, 0.4411832853077167, 0.316200649152474, 0.352718640403533, 0.5033458840051068, 0.31155857119745, 0.5359149158443719, -4.380551429930026, -0.38591889667947515, 0.18482213115652613, 0.681091595346584, 0.5655879938681119, 0.5932071643906006, 0.6029735471284923, 0.47939773252805296, 0.4697142914022753, 0.4626443389899304, 0.17501534977182318, 0.5029564354553162, 0.45137175867026436, 0.36004839941474176, 0.3903280188391314, 0.6715333602083582, 0.3718961693777487, 0.20955821238474007, 0.5780092137766678, 0.4066097226849503, 0.4951242311980657, 0.4983727282760763, 0.688426408759247, 0.98148705008097, -1.5970472693640436, -0.27795270232643904, 0.5890384472380967, 0.5197672255632545, 0.5606489839025897, 0.8044533400216373, 0.42624596896884076, 0.6139840865156629, 0.5171185616019347, 0.4904443400786127, 0.451915119741701, 0.3814479707354628, 0.349657693247199, 0.4782029257416907, 0.46615531183386744, 0.4002450550043556, 0.6160657486144413, 0.42088059555020535, 0.3649715745728848, 0.37748998254860655, 0.4322863758374626, 0.57257240373588, 0.6447937631401247, 1.0010987703847538, -1.206662704738544, -1.7975578728234551, 0.49207445308408043, 0.5599466202868565, 0.49856833696431674, 0.6377458797020129, 0.6042760919321541, 0.5467769540342745, 0.5374786874719552, 0.4954582772040273, 0.4679096589523392, 0.5149953184828582, 0.39795110599128103, 0.42674357147708175, 0.5621443466699507, 0.438899192951769, 0.5419792883761313, 0.4799558786824255, 0.4524547313048757, 0.5934853595488317, 0.6684831156941384, 0.5264408036268237, 0.07393673565871114, 0.5013054647456263, -3.46686853609228, -1.3869623678226546, -0.2955807918408224, 0.5020535383503001, 0.5043818998031417, 0.5680470913657567, 0.5358846849527829, 0.712799660382751, 0.556485640922583, 0.497075146798431, 0.3540001488279122, 0.5211485157798449, 0.5139675572813013, 0.47941439505885247, 0.6374653996048739, 0.5883973581602953, 0.3593304203326108, 0.49423934557992477, 0.4196811562227239, 0.4094716707284608, 0.46989865827656585, 0.5182955678585311, 0.34776944604362886, 0.4564614460924158, 0.8871420971425743, -0.31736665724308555, -0.3704048743690989, -0.3699576443687773, 0.6462583362464164, 0.4611782907959374, 0.6530903764772036, 0.46110992635200115, 0.5875386645919842, 0.6037563302867599, 0.5269794141020635, 0.5744669211720668, 0.46384797880903195, 0.518983623256468, 0.40610563773032715, 0.3551554271203499, 0.3411230684660221, 0.39371687129066363, 0.4595493192684594, 0.46942739366442376, 0.3828384566134616, 0.7194711690101506, -0.4640061370507862, 0.7213106265998601, -0.21195668762202016]
	plt.plot(ARIMA,"k-",label='ARIMA')
	plt.plot(QL,"b-",label='QL')
	plt.plot(DQN,"g-",label='DQN')
	plt.xlabel("hours")
	plt.ylabel("unit profit")
	plt.legend()
	plt.savefig('realtime.jpg', dpi=600, bbox_inches='tight')
	plt.show()

def draw_steps():
	x=[3,4,5,6,7,8]
	DQN=[2.8, 3.0036505, 3.61662, 3.8769, 4.046, 4.067745]
	#QL=[2.814, 2.927, 2.9881, 3.1456, 3.1844, 3.3481]
	QL2=[2.8, 2.87, 3.0222, 3.18247, 3.24815, 3.422]
	ARIMA=[2.5692438531626665, 2.624306781601123, 2.7147372768033096, 2.7623835599157553, 2.611871248621727, 2.57921944068807]
	plt.plot(x,QL2,"b*-",label='QL')
	plt.plot(x,DQN,"go-",label='DQN')
	plt.plot(x,ARIMA,"ks-",label='ARIMA')
	plt.xlabel("window size")
	plt.ylabel("unit profit")
	plt.legend()
	plt.savefig('steps.jpg', dpi=600, bbox_inches='tight')
	plt.show()

def draw_bar():
	#plt.bar(x,a, color=['r', 'b', 'm', 'g'])
	#method=['DQL', 'QL', 'ARIMA']
	#SS=[0.4774*302, 0.46*302, 0.32284*302]
	#greedy=[0.1227*302, 0.08336*302, -0.125*302]
	#FRE=[-0.278*302, -0.454*302, -0.57*302]
	method=['SS', 'GA', 'PSO', 'Greedy', 'FLE', 'FRE']
	x=np.arange(len(method))
	W=0.3
	DQL=[0.4774*302, 0.230882*302, 0.138*302, 0.1227*302, -0.095*302, -0.278*302]
	QL=[0.46*302, 0.15736*302, 0.09343*302, 0.08336*302, -0.095*302, -0.454*302]
	ARIMA=[0.32284*302, -0.015*302, -0.11173*302, -0.125*302, -0.095*302, -0.57*302]
	plt.bar(x, DQL, W, color='g', label='DQL')
	plt.bar(x+W, QL, W, color='b', label='QL')
	plt.bar(x+W+W, ARIMA, W, color='r', label='ARIMA')
	plt.xticks(x+W, method)
	plt.ylabel("Profit")
	plt.legend()
	plt.savefig('Profit.jpg', dpi=600, bbox_inches='tight')
	plt.show()

#ARIMA()
#DQL()
#draw_bar()
#draw_learning()

#4/8: QL, DQL done, traffic range 2~50, for 0.3, revenue=0.6~15*5, for 1.3, revenue=1~25*5
#4/9: 跑圖完成
#4/23:新增ARIMA
#8/2: 參數 F=120*(action+1)*2/10 revenue=users*QoS*2 cost=(abs(current-action)*2+2)*3
#8/3: DQN: SS 0.4774 greedy 0.1227, FRE -0.278, QL: SS 0.46, greedy: 0.08336 FRE -0.454, ARIMA: SS 0.32284, greedy -0.125, -0.57 *302